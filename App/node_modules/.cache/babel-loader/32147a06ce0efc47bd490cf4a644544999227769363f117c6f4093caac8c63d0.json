{"ast":null,"code":"var _jsxFileName = \"/Users/ohad/Desktop/GitCollaborationDemo/pat-addoption-ohadizr/App/src/Data/UserApi.jsx\";\nimport React from \"react\";\nimport localforage from \"localforage\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass UserApi extends React.Component {\n  constructor(props) {\n    super(props);\n    this.url = \"http://localhost:8000\";\n    this.state = {\n      users: [],\n      f_name: \"\",\n      l_name: \"\",\n      email: \"\",\n      password: \"\",\n      password_validate: \"\",\n      phone_num: \"\",\n      bio: \"\",\n      loading: true,\n      error: false\n    };\n  }\n  async setToken(token, user) {\n    try {\n      const petApp = await localforage.getItem(\"petApp\");\n      if (petApp !== null) {\n        await localforage.setItem(\"petApp\", {\n          token: token,\n          _id: user._id\n        });\n      } else {\n        await localforage.setItem(\"petApp\", {\n          token: token,\n          _id: user._id\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async verifyToken(token, id) {\n    try {\n      const data = null;\n      const petApp = await localforage.getItem(\"petApp\");\n      //compare token to token in local storage\n      petApp.token === token ? console.log(\"token is valid\") : data = response = {\n        status: 401,\n        message: \"token is not valid\"\n      };\n      if (petApp !== null) {\n        const response = await fetch(\"http://localhost:8000/verify\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            token: petApp.token\n          })\n        });\n        const data = await response.json();\n        console.log(data);\n        return data;\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async getToken() {\n    try {\n      const petApp = await localforage.getItem(\"petApp\");\n      return petApp;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async newUser(f_name, l_name, email, password, password_validate, phone_num, bio) {\n    try {\n      const response = await fetch(\"http://localhost:8000/signup\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          f_name: f_name,\n          l_name: l_name,\n          email: email,\n          password: password,\n          password_validate: password_validate,\n          phone_num: phone_num,\n          bio: bio\n        })\n      });\n      const data = await response.json();\n      console.log(data);\n      localStorage.setItem(\"petApp\", data.token);\n      //redirect to home page\n\n      return;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async login(email, password) {\n    const url = \"http://localhost:8000/login/\";\n    const body = JSON.stringify({\n      email,\n      password\n    });\n    const headers = {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\"\n    };\n    try {\n      const response = await fetch(url, {\n        method: \"POST\",\n        headers,\n        body\n      });\n      const data = await response.json();\n      console.log(data);\n      if (response.ok) {\n        return {\n          user: data.user,\n          token: data.token,\n          status: response.status\n        };\n      } else {\n        throw new Error(data.message || \"Login failed\");\n      }\n    } catch (error) {\n      console.error(error);\n      throw new Error(\"Network error\");\n    }\n  }\n\n  // await this.saveOnLocalForge(data.token, data.user);\n  // return {\n  //   status: response.status,\n  //   data: data,\n  //     }\n  //   } catch (error) {\n  //     console.log(error);\n  //   }\n  // }\n  async logout() {\n    try {\n      await localforage.removeItem(\"petApp\");\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async getUserById(_id, token) {\n    const bearer = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFAYS5jb20iLCJwYXNzd29yZCI6IjAzYWM2NzQyMTZmM2UxNWM3NjFlZTFhNWUyNTVmMDY3OTUzNjIzYzhiMzg4YjQ0NTllMTNmOTc4ZDdjODQ2ZjQiLCJpYXQiOjE2NzgwMjQ1MDR9.sds8UlB5VsOKOSdr_jppB6qpyBloWgwpFe3dqHxFEzI\";\n    const url = \"http://localhost:8000/user/\" + _id;\n    try {\n      const response = await fetch(url, {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${bearer}`\n        }\n      });\n      const result = await response.json();\n      return {\n        status: response.status,\n        data: result\n      };\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  render() {\n    if (this.state.loading) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 14\n      }, this);\n    }\n    if (this.state.error) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"error...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 14\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Users\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: this.state.users.map(user => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [user.f_name, \" \", user.l_name]\n        }, user.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }, this);\n  }\n}\nexport default UserApi;","map":{"version":3,"names":["React","localforage","useNavigate","UserApi","Component","constructor","props","url","state","users","f_name","l_name","email","password","password_validate","phone_num","bio","loading","error","setToken","token","user","petApp","getItem","setItem","_id","console","log","verifyToken","id","data","response","status","message","fetch","method","headers","body","JSON","stringify","json","getToken","newUser","localStorage","login","Accept","ok","Error","logout","removeItem","getUserById","bearer","Authorization","result","render","map"],"sources":["/Users/ohad/Desktop/GitCollaborationDemo/pat-addoption-ohadizr/App/src/Data/UserApi.jsx"],"sourcesContent":["import React from \"react\";\nimport localforage from \"localforage\";\nimport { useNavigate } from \"react-router-dom\";\n\nclass UserApi extends React.Component {\n  constructor(props) {\n    super(props);\n    this.url = \"http://localhost:8000\";\n    this.state = {\n      users: [],\n      f_name: \"\",\n      l_name: \"\",\n      email: \"\",\n      password: \"\",\n      password_validate: \"\",\n      phone_num: \"\",\n      bio: \"\",\n      loading: true,\n      error: false,\n    };\n  }\n\n  async setToken(token, user) {\n    try {\n      const petApp = await localforage.getItem(\"petApp\");\n\n      if (petApp !== null) {\n        await localforage.setItem(\"petApp\", {\n          token: token,\n          _id: user._id,\n        });\n      } else {\n        await localforage.setItem(\"petApp\", {\n          token: token,\n          _id: user._id,\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async verifyToken(token, id) {\n    try {\n      const data = null;\n      const petApp = await localforage.getItem(\"petApp\");\n      //compare token to token in local storage\n      petApp.token === token\n        ? console.log(\"token is valid\")\n        : (data = response =\n            {\n              status: 401,\n              message: \"token is not valid\",\n            });\n\n      if (petApp !== null) {\n        const response = await fetch(\"http://localhost:8000/verify\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            token: petApp.token,\n          }),\n        });\n        const data = await response.json();\n        console.log(data);\n        return data;\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async getToken() {\n    try {\n      const petApp = await localforage.getItem(\"petApp\");\n      return petApp;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async newUser(\n    f_name,\n    l_name,\n    email,\n    password,\n    password_validate,\n    phone_num,\n    bio\n  ) {\n    try {\n      const response = await fetch(\"http://localhost:8000/signup\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          f_name: f_name,\n          l_name: l_name,\n          email: email,\n          password: password,\n          password_validate: password_validate,\n          phone_num: phone_num,\n          bio: bio,\n        }),\n      });\n      const data = await response.json();\n      console.log(data);\n      localStorage.setItem(\"petApp\", data.token);\n      //redirect to home page\n\n      return;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async login(email, password) {\n    const url = \"http://localhost:8000/login/\";\n\n    const body = JSON.stringify({ email, password });\n    const headers = {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\",\n    };\n\n    try {\n      const response = await fetch(url, { method: \"POST\", headers, body });\n      const data = await response.json();\n      console.log(data);\n      if (response.ok) {\n        return { user: data.user, token: data.token, status: response.status };\n      } else {\n        throw new Error(data.message || \"Login failed\");\n      }\n    } catch (error) {\n      console.error(error);\n      throw new Error(\"Network error\");\n    }\n  }\n\n  // await this.saveOnLocalForge(data.token, data.user);\n  // return {\n  //   status: response.status,\n  //   data: data,\n  //     }\n  //   } catch (error) {\n  //     console.log(error);\n  //   }\n  // }\n  async logout() {\n    try {\n      await localforage.removeItem(\"petApp\");\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async getUserById(_id, token) {\n    const bearer =\n      \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFAYS5jb20iLCJwYXNzd29yZCI6IjAzYWM2NzQyMTZmM2UxNWM3NjFlZTFhNWUyNTVmMDY3OTUzNjIzYzhiMzg4YjQ0NTllMTNmOTc4ZDdjODQ2ZjQiLCJpYXQiOjE2NzgwMjQ1MDR9.sds8UlB5VsOKOSdr_jppB6qpyBloWgwpFe3dqHxFEzI\";\n\n    const url = \"http://localhost:8000/user/\" + _id;\n    try {\n      const response = await fetch(url, {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${bearer}`,\n        },\n      });\n      const result = await response.json();\n      return {\n        status: response.status,\n        data: result,\n      };\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  render() {\n    if (this.state.loading) {\n      return <div>loading...</div>;\n    }\n    if (this.state.error) {\n      return <div>error...</div>;\n    }\n    return (\n      <div>\n        <h1>Users</h1>\n        <ul>\n          {this.state.users.map((user) => (\n            <li key={user.id}>\n              {user.f_name} {user.l_name}\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default UserApi;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}